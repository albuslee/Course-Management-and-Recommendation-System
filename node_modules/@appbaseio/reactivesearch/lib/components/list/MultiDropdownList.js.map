{"version":3,"sources":["../../../src/components/list/MultiDropdownList.js"],"names":["MultiDropdownList","props","state","currentValue","options","locked","internalComponent","componentId","setQueryListener","onQueryChange","componentWillMount","addComponent","updateQueryOptions","setReact","selectedValue","setValue","defaultSelected","componentWillReceiveProps","nextProps","react","setState","dataField","buckets","updateQuery","Object","keys","selectAllLabel","filter","val","componentWillUnmount","removeComponent","generateQueryOptions","queryOptions","aggs","terms","field","size","order","sortBy","showMissing","missing","missingLabel","render","selectAll","length","key","style","className","title","innerClass","String","item","trim","map","placeholder","showCount","themePreset","renderListItem","defaultQuery","value","query","type","queryFormat","Array","isArray","includes","match_all","exists","listQuery","hasMissingTerm","should","concat","bool","must_not","queryArray","must","newReact","watchComponent","and","isDefaultValue","beforeValueChange","finalValues","forEach","del","obj","rest","performUpdate","onValueChange","customQuery","label","filterLabel","showFilter","URLParams","setQueryOptions","propTypes","funcRequired","func","string","stringRequired","stringArray","queryFormatSearch","number","sortByWithCount","defaultProps","mapStateToProps","aggregations","selectedValues","config","mapDispatchtoProps","dispatch","component","beforeQueryChange","updateQueryObject"],"mappings":"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","file":"MultiDropdownList.js","sourcesContent":["import React, { Component } from 'react';\n\nimport {\n\taddComponent,\n\tremoveComponent,\n\twatchComponent,\n\tupdateQuery,\n\tsetQueryOptions,\n\tsetQueryListener,\n} from '@appbaseio/reactivecore/lib/actions';\nimport {\n\tisEqual,\n\tgetQueryOptions,\n\tpushToAndClause,\n\tcheckValueChange,\n\tgetAggsOrder,\n\tcheckPropChange,\n\tcheckSomePropChange,\n\tgetClassName,\n} from '@appbaseio/reactivecore/lib/utils/helper';\n\nimport types from '@appbaseio/reactivecore/lib/utils/types';\n\nimport Title from '../../styles/Title';\nimport Container from '../../styles/Container';\nimport Dropdown from '../shared/Dropdown';\nimport { connect } from '../../utils';\n\nclass MultiDropdownList extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\tcurrentValue: {},\n\t\t\toptions: [],\n\t\t};\n\t\tthis.locked = false;\n\t\tthis.internalComponent = `${props.componentId}__internal`;\n\t\tprops.setQueryListener(props.componentId, props.onQueryChange, null);\n\t}\n\n\tcomponentWillMount() {\n\t\tthis.props.addComponent(this.internalComponent);\n\t\tthis.props.addComponent(this.props.componentId);\n\t\tthis.updateQueryOptions(this.props);\n\n\t\tthis.setReact(this.props);\n\n\t\tif (this.props.selectedValue) {\n\t\t\tthis.setValue(this.props.selectedValue, true);\n\t\t} else if (this.props.defaultSelected) {\n\t\t\tthis.setValue(this.props.defaultSelected, true);\n\t\t}\n\t}\n\n\tcomponentWillReceiveProps(nextProps) {\n\t\tcheckPropChange(\n\t\t\tthis.props.react,\n\t\t\tnextProps.react,\n\t\t\t() => this.setReact(nextProps),\n\t\t);\n\t\tcheckPropChange(\n\t\t\tthis.props.options,\n\t\t\tnextProps.options,\n\t\t\t() => {\n\t\t\t\tthis.setState({\n\t\t\t\t\toptions: nextProps.options[nextProps.dataField]\n\t\t\t\t\t\t? nextProps.options[nextProps.dataField].buckets\n\t\t\t\t\t\t: [],\n\t\t\t\t});\n\t\t\t},\n\t\t);\n\t\tcheckSomePropChange(\n\t\t\tthis.props,\n\t\t\tnextProps,\n\t\t\t['size', 'sortBy'],\n\t\t\t() => this.updateQueryOptions(nextProps),\n\t\t);\n\n\t\tcheckPropChange(\n\t\t\tthis.props.dataField,\n\t\t\tnextProps.dataField,\n\t\t\t() => {\n\t\t\t\tthis.updateQueryOptions(nextProps);\n\t\t\t\tthis.updateQuery(Object.keys(this.state.currentValue), nextProps);\n\t\t\t},\n\t\t);\n\n\t\tlet selectedValue = Object.keys(this.state.currentValue);\n\n\t\tif (this.props.selectAllLabel) {\n\t\t\tselectedValue = selectedValue.filter(val => val !== this.props.selectAllLabel);\n\n\t\t\tif (this.state.currentValue[this.props.selectAllLabel]) {\n\t\t\t\tselectedValue = [this.props.selectAllLabel];\n\t\t\t}\n\t\t}\n\n\t\tif (!isEqual(this.props.defaultSelected, nextProps.defaultSelected)) {\n\t\t\tthis.setValue(nextProps.defaultSelected, true);\n\t\t} else if (!isEqual(selectedValue, nextProps.selectedValue)) {\n\t\t\tthis.setValue(nextProps.selectedValue || [], true);\n\t\t}\n\t}\n\n\tcomponentWillUnmount() {\n\t\tthis.props.removeComponent(this.props.componentId);\n\t\tthis.props.removeComponent(this.internalComponent);\n\t}\n\n\tsetReact = (props) => {\n\t\tconst { react } = props;\n\t\tif (react) {\n\t\t\tconst newReact = pushToAndClause(react, this.internalComponent);\n\t\t\tprops.watchComponent(props.componentId, newReact);\n\t\t} else {\n\t\t\tprops.watchComponent(props.componentId, { and: this.internalComponent });\n\t\t}\n\t};\n\n\tstatic defaultQuery = (value, props) => {\n\t\tlet query = null;\n\t\tconst type = props.queryFormat === 'or' ? 'terms' : 'term';\n\n\t\tif (!Array.isArray(value) || value.length === 0) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif (props.selectAllLabel && value.includes(props.selectAllLabel)) {\n\t\t\tif (props.showMissing) {\n\t\t\t\tquery = { match_all: {} };\n\t\t\t} else {\n\t\t\t\tquery = {\n\t\t\t\t\texists: {\n\t\t\t\t\t\tfield: props.dataField,\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t}\n\t\t} else if (value) {\n\t\t\tlet listQuery;\n\t\t\tif (props.queryFormat === 'or') {\n\t\t\t\tif (props.showMissing) {\n\t\t\t\t\tconst hasMissingTerm = value.includes(props.missingLabel);\n\t\t\t\t\tlet should = [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t[type]: {\n\t\t\t\t\t\t\t\t[props.dataField]: value.filter(item => item !== props.missingLabel),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t];\n\t\t\t\t\tif (hasMissingTerm) {\n\t\t\t\t\t\tshould = should.concat({\n\t\t\t\t\t\t\tbool: {\n\t\t\t\t\t\t\t\tmust_not: {\n\t\t\t\t\t\t\t\t\texists: { field: props.dataField },\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tlistQuery = {\n\t\t\t\t\t\tbool: {\n\t\t\t\t\t\t\tshould,\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\tlistQuery = {\n\t\t\t\t\t\t[type]: {\n\t\t\t\t\t\t\t[props.dataField]: value,\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// adds a sub-query with must as an array of objects for each term/value\n\t\t\t\tconst queryArray = value.map(item => (\n\t\t\t\t\t{\n\t\t\t\t\t\t[type]: {\n\t\t\t\t\t\t\t[props.dataField]: item,\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t));\n\t\t\t\tlistQuery = {\n\t\t\t\t\tbool: {\n\t\t\t\t\t\tmust: queryArray,\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tquery = value.length ? listQuery : null;\n\t\t}\n\t\treturn query;\n\t};\n\n\tsetValue = (value, isDefaultValue = false, props = this.props) => {\n\t\t// ignore state updates when component is locked\n\t\tif (props.beforeValueChange && this.locked) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.locked = true;\n\t\tconst { selectAllLabel } = this.props;\n\t\tlet { currentValue } = this.state;\n\t\tlet finalValues = null;\n\n\t\tif (selectAllLabel && value.includes(selectAllLabel)) {\n\t\t\tif (currentValue[selectAllLabel]) {\n\t\t\t\tcurrentValue = {};\n\t\t\t\tfinalValues = [];\n\t\t\t} else {\n\t\t\t\tthis.state.options.forEach((item) => {\n\t\t\t\t\tcurrentValue[item.key] = true;\n\t\t\t\t});\n\t\t\t\tcurrentValue[selectAllLabel] = true;\n\t\t\t\tfinalValues = [selectAllLabel];\n\t\t\t}\n\t\t} else if (isDefaultValue) {\n\t\t\tfinalValues = value;\n\t\t\tcurrentValue = {};\n\t\t\tif (value) {\n\t\t\t\tvalue.forEach((item) => {\n\t\t\t\t\tcurrentValue[item] = true;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (selectAllLabel && selectAllLabel in currentValue) {\n\t\t\t\tconst { [selectAllLabel]: del, ...obj } = currentValue;\n\t\t\t\tcurrentValue = { ...obj };\n\t\t\t}\n\t\t} else {\n\t\t\tif (currentValue[value]) {\n\t\t\t\tconst { [value]: del, ...rest } = currentValue;\n\t\t\t\tcurrentValue = { ...rest };\n\t\t\t} else {\n\t\t\t\tcurrentValue[value] = true;\n\t\t\t}\n\n\t\t\tif (selectAllLabel && selectAllLabel in currentValue) {\n\t\t\t\tconst { [selectAllLabel]: del, ...obj } = currentValue;\n\t\t\t\tcurrentValue = { ...obj };\n\t\t\t}\n\t\t\tfinalValues = Object.keys(currentValue);\n\t\t}\n\n\t\tconst performUpdate = () => {\n\t\t\tthis.setState({\n\t\t\t\tcurrentValue,\n\t\t\t}, () => {\n\t\t\t\tthis.updateQuery(finalValues, props);\n\t\t\t\tthis.locked = false;\n\t\t\t\tif (props.onValueChange) props.onValueChange(finalValues);\n\t\t\t});\n\t\t};\n\n\t\tcheckValueChange(\n\t\t\tprops.componentId,\n\t\t\tfinalValues,\n\t\t\tprops.beforeValueChange,\n\t\t\tperformUpdate,\n\t\t);\n\t};\n\n\tupdateQuery = (value, props) => {\n\t\tconst query = props.customQuery || MultiDropdownList.defaultQuery;\n\n\t\tprops.updateQuery({\n\t\t\tcomponentId: props.componentId,\n\t\t\tquery: query(value, props),\n\t\t\tvalue,\n\t\t\tlabel: props.filterLabel,\n\t\t\tshowFilter: props.showFilter,\n\t\t\tURLParams: props.URLParams,\n\t\t});\n\t};\n\n\tstatic generateQueryOptions(props) {\n\t\tconst queryOptions = getQueryOptions(props);\n\t\tqueryOptions.aggs = {\n\t\t\t[props.dataField]: {\n\t\t\t\tterms: {\n\t\t\t\t\tfield: props.dataField,\n\t\t\t\t\tsize: props.size,\n\t\t\t\t\torder: getAggsOrder(props.sortBy || 'count'),\n\t\t\t\t\t...(props.showMissing ? { missing: props.missingLabel } : {}),\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\treturn queryOptions;\n\t}\n\n\tupdateQueryOptions = (props) => {\n\t\tconst queryOptions = MultiDropdownList.generateQueryOptions(props);\n\t\tprops.setQueryOptions(this.internalComponent, queryOptions);\n\t};\n\n\trender() {\n\t\tlet selectAll = [];\n\n\t\tif (this.state.options.length === 0) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.props.selectAllLabel) {\n\t\t\tselectAll = [{\n\t\t\t\tkey: this.props.selectAllLabel,\n\t\t\t}];\n\t\t}\n\n\t\treturn (\n\t\t\t<Container style={this.props.style} className={this.props.className}>\n\t\t\t\t{this.props.title && <Title className={getClassName(this.props.innerClass, 'title') || null}>{this.props.title}</Title>}\n\t\t\t\t<Dropdown\n\t\t\t\t\tinnerClass={this.props.innerClass}\n\t\t\t\t\titems={\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t...selectAll,\n\t\t\t\t\t\t\t...this.state.options\n\t\t\t\t\t\t\t\t.filter(item => String(item.key).trim().length)\n\t\t\t\t\t\t\t\t.map(item => ({ ...item, key: String(item.key) })),\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t\tonChange={this.setValue}\n\t\t\t\t\tselectedItem={this.state.currentValue}\n\t\t\t\t\tplaceholder={this.props.placeholder}\n\t\t\t\t\tlabelField=\"key\"\n\t\t\t\t\tmulti\n\t\t\t\t\tshowCount={this.props.showCount}\n\t\t\t\t\tthemePreset={this.props.themePreset}\n\t\t\t\t\trenderListItem={this.props.renderListItem}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t);\n\t}\n}\n\nMultiDropdownList.propTypes = {\n\taddComponent: types.funcRequired,\n\tremoveComponent: types.funcRequired,\n\tsetQueryListener: types.funcRequired,\n\tsetQueryOptions: types.funcRequired,\n\tupdateQuery: types.funcRequired,\n\twatchComponent: types.funcRequired,\n\toptions: types.options,\n\tselectedValue: types.selectedValue,\n\t// component props\n\tbeforeValueChange: types.func,\n\tclassName: types.string,\n\tcomponentId: types.stringRequired,\n\tcustomQuery: types.func,\n\tdataField: types.stringRequired,\n\tdefaultSelected: types.stringArray,\n\tfilterLabel: types.string,\n\tinnerClass: types.style,\n\tonQueryChange: types.func,\n\tonValueChange: types.func,\n\tplaceholder: types.string,\n\tqueryFormat: types.queryFormatSearch,\n\treact: types.react,\n\trenderListItem: types.func,\n\tselectAllLabel: types.string,\n\tshowCount: types.bool,\n\tshowFilter: types.bool,\n\tsize: types.number,\n\tsortBy: types.sortByWithCount,\n\tstyle: types.style,\n\tthemePreset: types.themePreset,\n\ttitle: types.title,\n\tURLParams: types.bool,\n\tshowMissing: types.bool,\n\tmissingLabel: types.string,\n};\n\nMultiDropdownList.defaultProps = {\n\tclassName: null,\n\tplaceholder: 'Select values',\n\tqueryFormat: 'or',\n\tshowCount: true,\n\tshowFilter: true,\n\tsize: 100,\n\tsortBy: 'count',\n\tstyle: {},\n\tURLParams: false,\n\tshowMissing: false,\n\tmissingLabel: 'N/A',\n};\n\nconst mapStateToProps = (state, props) => ({\n\toptions: state.aggregations[props.componentId],\n\tselectedValue: (state.selectedValues[props.componentId]\n\t\t&& state.selectedValues[props.componentId].value) || null,\n\tthemePreset: state.config.themePreset,\n});\n\nconst mapDispatchtoProps = dispatch => ({\n\taddComponent: component => dispatch(addComponent(component)),\n\tremoveComponent: component => dispatch(removeComponent(component)),\n\tsetQueryOptions: (component, props) => dispatch(setQueryOptions(component, props)),\n\tsetQueryListener: (component, onQueryChange, beforeQueryChange) =>\n\t\tdispatch(setQueryListener(component, onQueryChange, beforeQueryChange)),\n\tupdateQuery: updateQueryObject => dispatch(updateQuery(updateQueryObject)),\n\twatchComponent: (component, react) => dispatch(watchComponent(component, react)),\n});\n\nexport default connect(mapStateToProps, mapDispatchtoProps)(MultiDropdownList);\n"]}