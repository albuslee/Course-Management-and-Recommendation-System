{"version":3,"sources":["../../../src/components/search/CategorySearch.js"],"names":["Text","color","props","primary","theme","colors","primaryColor","textColor","children","CategorySearch","state","currentValue","suggestions","isOpen","internalComponent","componentId","locked","setQueryListener","onQueryChange","componentWillMount","addComponent","highlight","queryOptions","highlightQuery","size","setQueryOptions","setReact","aggsQuery","getAggsQuery","categoryField","selectedValue","setValue","defaultSelected","componentWillReceiveProps","nextProps","react","Array","isArray","trim","length","setState","onSuggestions","updateQuery","componentWillUnmount","removeComponent","render","suggestionsList","themePreset","defaultSuggestions","categories","categorySuggestions","label","value","category","key","style","className","title","innerClass","autosuggest","onSuggestionSelected","handleOuterClick","handleStateChange","i","getInputProps","getItemProps","highlightedIndex","showClear","showIcon","iconPosition","innerRef","placeholder","onChange","onInputChange","onBlur","onFocus","handleFocus","onKeyPress","onKeyDown","handleKeyDown","onKeyUp","renderIcons","slice","map","item","index","backgroundColor","getBackgroundColor","autoFocus","customHighlight","fields","highlightField","dataField","forEach","pre_tags","post_tags","defaultQuery","finalQuery","bool","should","shouldQuery","minimum_should_match","term","match_all","dataFields","field","fieldWeights","queryFormat","multi_match","query","type","operator","fuzziness","aggs","terms","newReact","watchComponent","and","searchSuggestions","onSuggestion","suggestion","toLowerCase","isDefaultValue","beforeValueChange","performUpdate","handleTextChange","onValueChange","debounce","customQuery","filterLabel","showFilter","URLParams","event","clearValue","target","blur","e","changes","stateChangeTypes","mouseUp","isDark","renderIcon","icon","renderCancelIcon","clearIcon","propTypes","funcRequired","options","data","func","string","stringRequired","dataFieldArray","number","stringOrArray","queryFormatSearch","defaultProps","mapStateToProps","aggregations","buckets","selectedValues","hits","config","mapDispatchtoProps","dispatch","component","execute","beforeQueryChange","updateQueryObject"],"mappings":"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","file":"CategorySearch.js","sourcesContent":["import React, { Component } from 'react';\nimport Downshift from 'downshift';\nimport { withTheme } from 'emotion-theming';\n\nimport {\n\taddComponent,\n\tremoveComponent,\n\twatchComponent,\n\tupdateQuery,\n\tsetQueryOptions,\n\tsetQueryListener,\n} from '@appbaseio/reactivecore/lib/actions';\nimport {\n\tdebounce,\n\tpushToAndClause,\n\tcheckValueChange,\n\tcheckPropChange,\n\tcheckSomePropChange,\n\tgetClassName,\n} from '@appbaseio/reactivecore/lib/utils/helper';\n\nimport types from '@appbaseio/reactivecore/lib/utils/types';\nimport getSuggestions from '@appbaseio/reactivecore/lib/utils/suggestions';\nimport Title from '../../styles/Title';\nimport Input, { suggestionsContainer, suggestions } from '../../styles/Input';\nimport CancelSvg from '../shared/CancelSvg';\nimport SearchSvg from '../shared/SearchSvg';\nimport InputIcon from '../../styles/InputIcon';\nimport Container from '../../styles/Container';\nimport { connect } from '../../utils';\n\nconst Text = withTheme(props => (\n\t<span\n\t\tclassName=\"trim\"\n\t\tstyle={{\n\t\t\tcolor: props.primary ? props.theme.colors.primaryColor : props.theme.colors.textColor,\n\t\t}}\n\t>\n\t\t{props.children}\n\t</span>\n));\n\nclass CategorySearch extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\tcurrentValue: '',\n\t\t\tsuggestions: [],\n\t\t\tisOpen: false,\n\t\t};\n\t\tthis.internalComponent = `${props.componentId}__internal`;\n\t\tthis.locked = false;\n\t\tprops.setQueryListener(props.componentId, props.onQueryChange, null);\n\t}\n\n\tcomponentWillMount() {\n\t\tthis.props.addComponent(this.props.componentId);\n\t\tthis.props.addComponent(this.internalComponent);\n\n\t\tif (this.props.highlight) {\n\t\t\tconst queryOptions = CategorySearch.highlightQuery(this.props) || {};\n\t\t\tqueryOptions.size = 20;\n\t\t\tthis.props.setQueryOptions(this.props.componentId, queryOptions);\n\t\t} else {\n\t\t\tthis.props.setQueryOptions(this.props.componentId, {\n\t\t\t\tsize: 20,\n\t\t\t});\n\t\t}\n\t\tthis.setReact(this.props);\n\n\t\tconst aggsQuery = this.getAggsQuery(this.props.categoryField);\n\t\tthis.props.setQueryOptions(this.internalComponent, aggsQuery, false);\n\n\t\tif (this.props.selectedValue) {\n\t\t\tthis.setValue(this.props.selectedValue, true);\n\t\t} else if (this.props.defaultSelected) {\n\t\t\tthis.setValue(this.props.defaultSelected, true);\n\t\t}\n\t}\n\n\tcomponentWillReceiveProps(nextProps) {\n\t\tcheckSomePropChange(\n\t\t\tthis.props,\n\t\t\tnextProps,\n\t\t\t['highlight', 'dataField', 'highlightField'],\n\t\t\t() => {\n\t\t\t\tconst queryOptions = CategorySearch.highlightQuery(nextProps) || {};\n\t\t\t\tqueryOptions.size = 20;\n\t\t\t\tthis.props.setQueryOptions(nextProps.componentId, queryOptions);\n\t\t\t},\n\t\t);\n\n\t\tcheckPropChange(this.props.react, nextProps.react, () =>\n\t\t\tthis.setReact(nextProps));\n\n\t\tif (\n\t\t\tArray.isArray(nextProps.suggestions)\n\t\t\t&& this.state.currentValue.trim().length\n\t\t) {\n\t\t\t// shallow check allows us to set suggestions even if the next set\n\t\t\t// of suggestions are same as the current one\n\t\t\tif (this.props.suggestions !== nextProps.suggestions) {\n\t\t\t\tthis.setState({\n\t\t\t\t\tsuggestions: this.onSuggestions(nextProps.suggestions),\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tcheckSomePropChange(\n\t\t\tthis.props,\n\t\t\tnextProps,\n\t\t\t['fieldWeights', 'fuzziness', 'queryFormat', 'dataField', 'categoryField'],\n\t\t\t() => {\n\t\t\t\tthis.updateQuery(\n\t\t\t\t\tnextProps.componentId,\n\t\t\t\t\tthis.state.currentValue,\n\t\t\t\t\tnextProps,\n\t\t\t\t);\n\t\t\t},\n\t\t);\n\n\t\tif (this.props.defaultSelected !== nextProps.defaultSelected) {\n\t\t\tthis.setValue(nextProps.defaultSelected, true, nextProps);\n\t\t} else if (\n\t\t\t// since, selectedValue will be updated when currentValue changes,\n\t\t\t// we must only check for the changes introduced by\n\t\t\t// clear action from SelectedFilters component in which case,\n\t\t\t// the currentValue will never match the updated selectedValue\n\t\t\tthis.props.selectedValue !== nextProps.selectedValue\n\t\t\t&& this.state.currentValue !== nextProps.selectedValue\n\t\t) {\n\t\t\tthis.setValue(nextProps.selectedValue || '', true, nextProps);\n\t\t}\n\t}\n\n\tcomponentWillUnmount() {\n\t\tthis.props.removeComponent(this.props.componentId);\n\t\tthis.props.removeComponent(this.internalComponent);\n\t}\n\n\tgetAggsQuery = field => ({\n\t\taggs: {\n\t\t\t[field]: {\n\t\t\t\tterms: {\n\t\t\t\t\tfield,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t});\n\n\tsetReact = (props) => {\n\t\tconst { react } = props;\n\t\tif (react) {\n\t\t\tconst newReact = pushToAndClause(react, this.internalComponent);\n\t\t\tprops.watchComponent(props.componentId, newReact);\n\t\t} else {\n\t\t\tprops.watchComponent(props.componentId, { and: this.internalComponent });\n\t\t}\n\t};\n\n\tstatic highlightQuery = (props) => {\n\t\tif (props.customHighlight) {\n\t\t\treturn props.customHighlight(props);\n\t\t}\n\t\tif (!props.highlight) {\n\t\t\treturn null;\n\t\t}\n\t\tconst fields = {};\n\t\tconst highlightField = props.highlightField\n\t\t\t? props.highlightField\n\t\t\t: props.dataField;\n\n\t\tif (typeof highlightField === 'string') {\n\t\t\tfields[highlightField] = {};\n\t\t} else if (Array.isArray(highlightField)) {\n\t\t\thighlightField.forEach((item) => {\n\t\t\t\tfields[item] = {};\n\t\t\t});\n\t\t}\n\n\t\treturn {\n\t\t\thighlight: {\n\t\t\t\tpre_tags: ['<mark>'],\n\t\t\t\tpost_tags: ['</mark>'],\n\t\t\t\tfields,\n\t\t\t},\n\t\t};\n\t};\n\n\tstatic defaultQuery = (value, props, category) => {\n\t\tlet finalQuery = null;\n\t\tlet fields;\n\n\t\tif (value) {\n\t\t\tif (Array.isArray(props.dataField)) {\n\t\t\t\tfields = props.dataField;\n\t\t\t} else {\n\t\t\t\tfields = [props.dataField];\n\t\t\t}\n\t\t\tfinalQuery = {\n\t\t\t\tbool: {\n\t\t\t\t\tshould: CategorySearch.shouldQuery(value, fields, props),\n\t\t\t\t\tminimum_should_match: '1',\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tif (category && category !== '*') {\n\t\t\t\tfinalQuery = [\n\t\t\t\t\tfinalQuery,\n\t\t\t\t\t{\n\t\t\t\t\t\tterm: {\n\t\t\t\t\t\t\t[props.categoryField]: category,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t];\n\t\t\t}\n\t\t}\n\n\t\tif (value === '') {\n\t\t\tfinalQuery = {\n\t\t\t\tmatch_all: {},\n\t\t\t};\n\t\t}\n\n\t\treturn finalQuery;\n\t};\n\n\tstatic shouldQuery = (value, dataFields, props) => {\n\t\tconst fields = dataFields.map((field, index) =>\n\t\t\t`${field}${\n\t\t\t\tArray.isArray(props.fieldWeights) && props.fieldWeights[index]\n\t\t\t\t\t? `^${props.fieldWeights[index]}`\n\t\t\t\t\t: ''\n\t\t\t}`);\n\n\t\tif (props.queryFormat === 'and') {\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\tmulti_match: {\n\t\t\t\t\t\tquery: value,\n\t\t\t\t\t\tfields,\n\t\t\t\t\t\ttype: 'cross_fields',\n\t\t\t\t\t\toperator: 'and',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tmulti_match: {\n\t\t\t\t\t\tquery: value,\n\t\t\t\t\t\tfields,\n\t\t\t\t\t\ttype: 'phrase_prefix',\n\t\t\t\t\t\toperator: 'and',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t];\n\t\t}\n\n\t\treturn [\n\t\t\t{\n\t\t\t\tmulti_match: {\n\t\t\t\t\tquery: value,\n\t\t\t\t\tfields,\n\t\t\t\t\ttype: 'best_fields',\n\t\t\t\t\toperator: 'or',\n\t\t\t\t\tfuzziness: props.fuzziness ? props.fuzziness : 0,\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tmulti_match: {\n\t\t\t\t\tquery: value,\n\t\t\t\t\tfields,\n\t\t\t\t\ttype: 'phrase_prefix',\n\t\t\t\t\toperator: 'or',\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\t};\n\n\tonSuggestions = (searchSuggestions) => {\n\t\tif (this.props.onSuggestion) {\n\t\t\treturn searchSuggestions.map(suggestion => this.props.onSuggestion(suggestion));\n\t\t}\n\n\t\tconst fields = Array.isArray(this.props.dataField)\n\t\t\t? this.props.dataField\n\t\t\t: [this.props.dataField];\n\n\t\treturn getSuggestions(\n\t\t\tfields,\n\t\t\tsearchSuggestions,\n\t\t\tthis.state.currentValue.toLowerCase(),\n\t\t);\n\t};\n\n\tsetValue = (value, isDefaultValue = false, props = this.props, category) => {\n\t\t// ignore state updates when component is locked\n\t\tif (props.beforeValueChange && this.locked) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.locked = true;\n\t\tconst performUpdate = () => {\n\t\t\tthis.setState({\n\t\t\t\tcurrentValue: value,\n\t\t\t}, () => {\n\t\t\t\tif (isDefaultValue) {\n\t\t\t\t\tif (this.props.autosuggest) {\n\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\tisOpen: false,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.updateQuery(this.internalComponent, value, props);\n\t\t\t\t\t}\n\t\t\t\t\tthis.updateQuery(props.componentId, value, props, category);\n\t\t\t\t} else {\n\t\t\t\t\t// debounce for handling text while typing\n\t\t\t\t\tthis.handleTextChange(value);\n\t\t\t\t}\n\t\t\t\tthis.locked = false;\n\t\t\t\tif (props.onValueChange) props.onValueChange(value);\n\t\t\t});\n\t\t};\n\t\tcheckValueChange(\n\t\t\tprops.componentId,\n\t\t\tvalue,\n\t\t\tprops.beforeValueChange,\n\t\t\tperformUpdate,\n\t\t);\n\t};\n\n\thandleTextChange = debounce((value) => {\n\t\tif (this.props.autosuggest) {\n\t\t\tthis.updateQuery(this.internalComponent, value, this.props);\n\t\t} else {\n\t\t\tthis.updateQuery(this.props.componentId, value, this.props);\n\t\t}\n\t}, this.props.debounce);\n\n\tupdateQuery = (componentId, value, props, category) => {\n\t\tconst query = props.customQuery || CategorySearch.defaultQuery;\n\n\t\tprops.updateQuery({\n\t\t\tcomponentId,\n\t\t\tquery: query(value, props, category),\n\t\t\tvalue,\n\t\t\tlabel: props.filterLabel,\n\t\t\tshowFilter: props.showFilter,\n\t\t\tURLParams: props.URLParams,\n\t\t});\n\t};\n\n\thandleFocus = (event) => {\n\t\tthis.setState({\n\t\t\tisOpen: true,\n\t\t});\n\t\tif (this.props.onFocus) {\n\t\t\tthis.props.onFocus(event);\n\t\t}\n\t};\n\n\tclearValue = () => {\n\t\tthis.setValue('', true);\n\t};\n\n\t// only works if there's a change in downshift's value\n\thandleOuterClick = () => {\n\t\tthis.setValue(this.state.currentValue, true);\n\t};\n\n\thandleKeyDown = (event) => {\n\t\tif (event.key === 'Enter') {\n\t\t\tevent.target.blur();\n\t\t\tthis.setValue(event.target.value, true);\n\t\t}\n\t\tif (this.props.onKeyDown) {\n\t\t\tthis.props.onKeyDown(event);\n\t\t}\n\t};\n\n\tonInputChange = (e) => {\n\t\tconst { value } = e.target;\n\t\tif (value.trim() !== this.state.currentValue.trim()) {\n\t\t\tthis.setState({\n\t\t\t\tsuggestions: [],\n\t\t\t}, () => {\n\t\t\t\tthis.setValue(value);\n\t\t\t});\n\t\t} else {\n\t\t\tthis.setValue(value);\n\t\t}\n\t};\n\n\tonSuggestionSelected = (suggestion, event) => {\n\t\tthis.setValue(suggestion.value, true, this.props, suggestion.category);\n\t\tif (this.props.onBlur) {\n\t\t\tthis.props.onBlur(event);\n\t\t}\n\t};\n\n\thandleStateChange = (changes) => {\n\t\tconst { isOpen, type } = changes;\n\t\tif (type === Downshift.stateChangeTypes.mouseUp) {\n\t\t\tthis.setState({\n\t\t\t\tisOpen,\n\t\t\t});\n\t\t}\n\t};\n\n\tgetBackgroundColor = (highlightedIndex, index) => {\n\t\tconst isDark = this.props.themePreset === 'dark';\n\t\tif (isDark) {\n\t\t\treturn highlightedIndex === index\n\t\t\t\t? '#555' : '#424242';\n\t\t}\n\t\treturn highlightedIndex === index\n\t\t\t? '#eee' : '#fff';\n\t};\n\n\trenderIcon = () => {\n\t\tif (this.props.showIcon) {\n\t\t\treturn this.props.icon || <SearchSvg />;\n\t\t}\n\t\treturn null;\n\t};\n\n\trenderCancelIcon = () => {\n\t\tif (this.props.showClear) {\n\t\t\treturn this.props.clearIcon || <CancelSvg />;\n\t\t}\n\t\treturn null;\n\t}\n\n\trenderIcons = () => (\n\t\t<div>\n\t\t\t{\n\t\t\t\tthis.state.currentValue && this.props.showClear\n\t\t\t\t&& (\n\t\t\t\t\t<InputIcon\n\t\t\t\t\t\tonClick={this.clearValue}\n\t\t\t\t\t\ticonPosition=\"right\"\n\t\t\t\t\t\tclearIcon={this.props.iconPosition === 'right'}\n\t\t\t\t\t>\n\t\t\t\t\t\t{this.renderCancelIcon()}\n\t\t\t\t\t</InputIcon>\n\t\t\t\t)\n\t\t\t}\n\t\t\t<InputIcon iconPosition={this.props.iconPosition}>{this.renderIcon()}</InputIcon>\n\t\t</div>\n\t);\n\n\trender() {\n\t\tlet suggestionsList = [];\n\t\tconst { theme, themePreset } = this.props;\n\n\t\tif (\n\t\t\t!this.state.currentValue\n\t\t\t&& this.props.defaultSuggestions\n\t\t\t&& this.props.defaultSuggestions.length\n\t\t) {\n\t\t\tsuggestionsList = this.props.defaultSuggestions;\n\t\t} else if (this.state.currentValue) {\n\t\t\tsuggestionsList = this.state.suggestions;\n\t\t}\n\n\t\tif (\n\t\t\tthis.state.currentValue\n\t\t\t&& this.state.suggestions.length\n\t\t\t&& this.props.categories\n\t\t\t&& this.props.categories.length\n\t\t) {\n\t\t\tlet categorySuggestions = [\n\t\t\t\t{\n\t\t\t\t\tlabel: `${this.state.currentValue} in all categories`,\n\t\t\t\t\tvalue: this.state.currentValue,\n\t\t\t\t\tcategory: '*',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: `${this.state.currentValue} in ${\n\t\t\t\t\t\tthis.props.categories[0].key\n\t\t\t\t\t}`,\n\t\t\t\t\tvalue: this.state.currentValue,\n\t\t\t\t\tcategory: this.props.categories[0].key,\n\t\t\t\t},\n\t\t\t];\n\n\t\t\tif (this.props.categories.length > 1) {\n\t\t\t\tcategorySuggestions = [\n\t\t\t\t\t...categorySuggestions,\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: `${this.state.currentValue} in ${\n\t\t\t\t\t\t\tthis.props.categories[1].key\n\t\t\t\t\t\t}`,\n\t\t\t\t\t\tvalue: this.state.currentValue,\n\t\t\t\t\t\tcategory: this.props.categories[1].key,\n\t\t\t\t\t},\n\t\t\t\t];\n\t\t\t}\n\t\t\tsuggestionsList = [...categorySuggestions, ...suggestionsList];\n\t\t}\n\n\t\treturn (\n\t\t\t<Container style={this.props.style} className={this.props.className}>\n\t\t\t\t{this.props.title && (\n\t\t\t\t\t<Title\n\t\t\t\t\t\tclassName={getClassName(this.props.innerClass, 'title') || null}\n\t\t\t\t\t>\n\t\t\t\t\t\t{this.props.title}\n\t\t\t\t\t</Title>\n\t\t\t\t)}\n\t\t\t\t{this.props.autosuggest ? (\n\t\t\t\t\t<Downshift\n\t\t\t\t\t\tid={`${this.props.componentId}-downshift`}\n\t\t\t\t\t\tonChange={this.onSuggestionSelected}\n\t\t\t\t\t\tonOuterClick={this.handleOuterClick}\n\t\t\t\t\t\tonStateChange={this.handleStateChange}\n\t\t\t\t\t\tisOpen={this.state.isOpen}\n\t\t\t\t\t\titemToString={i => i}\n\t\t\t\t\t\trender={({\n\t\t\t\t\t\t\tgetInputProps,\n\t\t\t\t\t\t\tgetItemProps,\n\t\t\t\t\t\t\tisOpen,\n\t\t\t\t\t\t\thighlightedIndex,\n\t\t\t\t\t\t}) => (\n\t\t\t\t\t\t\t<div className={suggestionsContainer}>\n\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\tshowClear={this.props.showClear}\n\t\t\t\t\t\t\t\t\tid={`${this.props.componentId}-input`}\n\t\t\t\t\t\t\t\t\tshowIcon={this.props.showIcon}\n\t\t\t\t\t\t\t\t\ticonPosition={this.props.iconPosition}\n\t\t\t\t\t\t\t\t\tinnerRef={this.props.innerRef}\n\t\t\t\t\t\t\t\t\t{...getInputProps({\n\t\t\t\t\t\t\t\t\t\tclassName: getClassName(this.props.innerClass, 'input'),\n\t\t\t\t\t\t\t\t\t\tplaceholder: this.props.placeholder,\n\t\t\t\t\t\t\t\t\t\tvalue:\n\t\t\t\t\t\t\t\t\t\t\tthis.state.currentValue === null\n\t\t\t\t\t\t\t\t\t\t\t\t? ''\n\t\t\t\t\t\t\t\t\t\t\t\t: this.state.currentValue,\n\t\t\t\t\t\t\t\t\t\tonChange: this.onInputChange,\n\t\t\t\t\t\t\t\t\t\tonBlur: this.props.onBlur,\n\t\t\t\t\t\t\t\t\t\tonFocus: this.handleFocus,\n\t\t\t\t\t\t\t\t\t\tonKeyPress: this.props.onKeyPress,\n\t\t\t\t\t\t\t\t\t\tonKeyDown: this.handleKeyDown,\n\t\t\t\t\t\t\t\t\t\tonKeyUp: this.props.onKeyUp,\n\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\tthemePreset={themePreset}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t{this.renderIcons()}\n\t\t\t\t\t\t\t\t{isOpen && suggestionsList.length ? (\n\t\t\t\t\t\t\t\t\t<ul\n\t\t\t\t\t\t\t\t\t\tclassName={`${suggestions(themePreset, theme)} ${getClassName(this.props.innerClass, 'list')}`}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{suggestionsList.slice(0, 10).map((item, index) => (\n\t\t\t\t\t\t\t\t\t\t\t<li\n\t\t\t\t\t\t\t\t\t\t\t\t{...getItemProps({ item })}\n\t\t\t\t\t\t\t\t\t\t\t\tkey={`${index + 1}-${item.value}`}\n\t\t\t\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\t\t\t\tbackgroundColor: this.getBackgroundColor(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\thighlightedIndex,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tindex,\n\t\t\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<Text primary={!!item.category}>{item.label}</Text>\n\t\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t/>\n\t\t\t\t) : (\n\t\t\t\t\t<div className={suggestionsContainer}>\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\tclassName={getClassName(this.props.innerClass, 'input')}\n\t\t\t\t\t\t\tplaceholder={this.props.placeholder}\n\t\t\t\t\t\t\tvalue={this.state.currentValue ? this.state.currentValue : ''}\n\t\t\t\t\t\t\tonChange={this.onInputChange}\n\t\t\t\t\t\t\tonBlur={this.props.onBlur}\n\t\t\t\t\t\t\tonFocus={this.props.onFocus}\n\t\t\t\t\t\t\tonKeyPress={this.props.onKeyPress}\n\t\t\t\t\t\t\tonKeyDown={this.props.onKeyDown}\n\t\t\t\t\t\t\tonKeyUp={this.props.onKeyUp}\n\t\t\t\t\t\t\tautoFocus={this.props.autoFocus}\n\t\t\t\t\t\t\ticonPosition={this.props.iconPosition}\n\t\t\t\t\t\t\tshowClear={this.props.showClear}\n\t\t\t\t\t\t\tshowIcon={this.props.showIcon}\n\t\t\t\t\t\t\tinnerRef={this.props.innerRef}\n\t\t\t\t\t\t\tthemePreset={themePreset}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{this.renderIcons()}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</Container>\n\t\t);\n\t}\n}\n\nCategorySearch.propTypes = {\n\taddComponent: types.funcRequired,\n\tremoveComponent: types.funcRequired,\n\tsetQueryListener: types.funcRequired,\n\tsetQueryOptions: types.funcRequired,\n\tupdateQuery: types.funcRequired,\n\twatchComponent: types.funcRequired,\n\toptions: types.options,\n\tcategories: types.data,\n\tselectedValue: types.selectedValue,\n\tsuggestions: types.suggestions,\n\t// component props\n\tautoFocus: types.bool,\n\tautosuggest: types.bool,\n\tbeforeValueChange: types.func,\n\tcategoryField: types.string,\n\tclassName: types.string,\n\tclearIcon: types.children,\n\tcomponentId: types.stringRequired,\n\tcustomHighlight: types.func,\n\tcustomQuery: types.func,\n\tdataField: types.dataFieldArray,\n\tdebounce: types.number,\n\tdefaultSelected: types.string,\n\tdefaultSuggestions: types.suggestions,\n\tfieldWeights: types.fieldWeights,\n\tfilterLabel: types.string,\n\tfuzziness: types.fuzziness,\n\thighlight: types.bool,\n\thighlightField: types.stringOrArray,\n\ticon: types.children,\n\ticonPosition: types.iconPosition,\n\tinnerClass: types.style,\n\tinnerRef: types.func,\n\tonBlur: types.func,\n\tonFocus: types.func,\n\tonKeyDown: types.func,\n\tonKeyPress: types.func,\n\tonKeyUp: types.func,\n\tonQueryChange: types.func,\n\tonSuggestion: types.func,\n\tonValueChange: types.func,\n\tplaceholder: types.string,\n\tqueryFormat: types.queryFormatSearch,\n\treact: types.react,\n\tshowClear: types.bool,\n\tshowFilter: types.bool,\n\tshowIcon: types.bool,\n\tstyle: types.style,\n\ttitle: types.title,\n\ttheme: types.style,\n\tthemePreset: types.themePreset,\n\tURLParams: types.bool,\n};\n\nCategorySearch.defaultProps = {\n\tautosuggest: true,\n\tclassName: null,\n\tdebounce: 0,\n\ticonPosition: 'left',\n\tplaceholder: 'Search',\n\tqueryFormat: 'or',\n\tshowClear: false,\n\tshowFilter: true,\n\tshowIcon: true,\n\tstyle: {},\n\tURLParams: false,\n};\n\nconst mapStateToProps = (state, props) => ({\n\tcategories: (\n\t\tstate.aggregations[props.componentId]\n\t\t&& state.aggregations[props.componentId][props.categoryField]\n\t\t&& state.aggregations[props.componentId][props.categoryField].buckets\n\t) || [],\n\tselectedValue: (state.selectedValues[props.componentId]\n\t\t&& state.selectedValues[props.componentId].value) || null,\n\tsuggestions: (state.hits[props.componentId] && state.hits[props.componentId].hits) || [],\n\tthemePreset: state.config.themePreset,\n});\n\nconst mapDispatchtoProps = dispatch => ({\n\taddComponent: component => dispatch(addComponent(component)),\n\tremoveComponent: component => dispatch(removeComponent(component)),\n\tsetQueryOptions: (component, props, execute) =>\n\t\tdispatch(setQueryOptions(component, props, execute)),\n\tsetQueryListener: (component, onQueryChange, beforeQueryChange) =>\n\t\tdispatch(setQueryListener(component, onQueryChange, beforeQueryChange)),\n\tupdateQuery: updateQueryObject => dispatch(updateQuery(updateQueryObject)),\n\twatchComponent: (component, react) => dispatch(watchComponent(component, react)),\n});\n\nexport default connect(\n\tmapStateToProps,\n\tmapDispatchtoProps,\n)(withTheme(CategorySearch));\n"]}