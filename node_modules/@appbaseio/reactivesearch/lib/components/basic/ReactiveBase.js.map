{"version":3,"sources":["../../../src/components/basic/ReactiveBase.js"],"names":["URLSearchParams","require","Provider","ReactiveBase","props","type","credentials","url","trim","config","app","queryParams","window","location","search","params","selectedValues","Array","from","keys","forEach","key","value","JSON","parse","get","e","headers","themePreset","appbaseRef","initialState","mapKey","store","componentDidCatch","console","error","process","env","VERSION","version","render","theme","style","className","children","defaultProps","propTypes","stringRequired","string"],"mappings":"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","file":"ReactiveBase.js","sourcesContent":["/* eslint-disable global-require */\n\nimport React, { Component } from 'react';\nimport { createProvider } from 'react-redux';\nimport Appbase from 'appbase-js';\nimport { ThemeProvider } from 'emotion-theming';\n\nimport configureStore, { storeKey } from '@appbaseio/reactivecore';\nimport types from '@appbaseio/reactivecore/lib/utils/types';\nimport URLParamsProvider from './URLParamsProvider';\n\nimport getTheme from '../../styles/theme';\nimport { composeThemeObject } from '../../utils';\n\nconst URLSearchParams = require('url-search-params');\n\n/* use a custom store key so reactivesearch does not interfere\n   with a different redux store in a nested context */\nconst Provider = createProvider(storeKey);\n\nclass ReactiveBase extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.type = props.type ? props.type : '*';\n\n\t\tconst credentials = props.url && props.url.trim() !== '' && !props.credentials\n\t\t\t? null\n\t\t\t: props.credentials;\n\n\t\tconst config = {\n\t\t\turl: props.url && props.url.trim() !== '' ? props.url : 'https://scalr.api.appbase.io',\n\t\t\tapp: props.app,\n\t\t\tcredentials,\n\t\t\ttype: this.type,\n\t\t};\n\n\t\tlet queryParams = '';\n\t\tif (typeof window !== 'undefined') {\n\t\t\tqueryParams = window.location.search;\n\t\t} else {\n\t\t\tqueryParams = this.props.queryParams || '';\n\t\t}\n\n\t\tthis.params = new URLSearchParams(queryParams);\n\t\tlet selectedValues = {};\n\n\t\ttry {\n\t\t\tArray.from(this.params.keys()).forEach((key) => {\n\t\t\t\tselectedValues = { ...selectedValues, [key]: { value: JSON.parse(this.params.get(key)) } };\n\t\t\t});\n\t\t} catch (e) {\n\t\t\tselectedValues = {};\n\t\t}\n\n\t\tconst { headers = {}, themePreset } = props;\n\t\tconst appbaseRef = new Appbase(config);\n\n\t\tconst initialState = {\n\t\t\tconfig: { ...config, mapKey: props.mapKey, themePreset },\n\t\t\tappbaseRef,\n\t\t\tselectedValues,\n\t\t\theaders,\n\t\t\t...this.props.initialState,\n\t\t};\n\t\tthis.store = configureStore(initialState);\n\t}\n\n\tcomponentDidCatch() {\n\t\tconsole.error(\n\t\t\t'An error has occured. You\\'re using Reactivesearch Version:',\n\t\t\t`${process.env.VERSION || require('../../../package.json').version}.`,\n\t\t\t'If you think this is a problem with Reactivesearch, please try updating',\n\t\t\t'to the latest version. If you\\'re already at the latest version, please open',\n\t\t\t'an issue at https://github.com/appbaseio/reactivesearch/issues',\n\t\t);\n\t}\n\n\trender() {\n\t\tconst theme = composeThemeObject(\n\t\t\tgetTheme(this.props.themePreset),\n\t\t\tthis.props.theme,\n\t\t);\n\t\treturn (\n\t\t\t<ThemeProvider\n\t\t\t\ttheme={theme}\n\t\t\t>\n\t\t\t\t<Provider store={this.store}>\n\t\t\t\t\t<URLParamsProvider\n\t\t\t\t\t\tparams={this.params}\n\t\t\t\t\t\theaders={this.props.headers}\n\t\t\t\t\t\tstyle={this.props.style}\n\t\t\t\t\t\tclassName={this.props.className}\n\t\t\t\t\t>\n\t\t\t\t\t\t{this.props.children}\n\t\t\t\t\t</URLParamsProvider>\n\t\t\t\t</Provider>\n\t\t\t</ThemeProvider>\n\t\t);\n\t}\n}\n\nReactiveBase.defaultProps = {\n\ttheme: {},\n\tthemePreset: 'light',\n\tinitialState: {},\n};\n\nReactiveBase.propTypes = {\n\tapp: types.stringRequired,\n\tchildren: types.children,\n\tcredentials: types.string,\n\theaders: types.headers,\n\tqueryParams: types.string,\n\ttheme: types.style,\n\tthemePreset: types.themePreset,\n\ttype: types.string,\n\turl: types.string,\n\tmapKey: types.string,\n\tstyle: types.style,\n\tclassName: types.string,\n\tinitialState: types.children,\n};\n\nexport default ReactiveBase;\n"]}