{"version":3,"sources":["../../../src/components/basic/URLParamsProvider.js"],"names":["URLParamsProvider","componentWillReceiveProps","nextProps","props","selectedValues","Object","keys","filter","item","URLParams","forEach","component","setURL","getValue","value","params","delete","pushToHistory","length","Array","from","headers","setHeaders","isArray","map","location","label","key","trim","data","JSON","stringify","get","set","window","history","pushState","paramsSting","toString","base","href","split","newurl","path","render","style","className","children","propTypes","func","string","defaultProps","mapStateToProps","state","mapDispatchtoProps","dispatch"],"mappings":"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","file":"URLParamsProvider.js","sourcesContent":["import React, { Component } from 'react';\nimport { setHeaders } from '@appbaseio/reactivecore/lib/actions';\nimport types from '@appbaseio/reactivecore/lib/utils/types';\nimport { isEqual } from '@appbaseio/reactivecore/lib/utils/helper';\n\nimport Base from '../../styles/Base';\nimport { connect } from '../../utils';\n\nclass URLParamsProvider extends Component {\n\tcomponentWillReceiveProps(nextProps) {\n\t\tif (!isEqual(this.props.selectedValues, nextProps.selectedValues)) {\n\t\t\tObject.keys(nextProps.selectedValues)\n\t\t\t\t.filter(item => nextProps.selectedValues[item].URLParams)\n\t\t\t\t.forEach((component) => {\n\t\t\t\t\tif (nextProps.selectedValues[component].URLParams) {\n\t\t\t\t\t\tthis.setURL(component, this.getValue(nextProps.selectedValues[component].value));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.props.params.delete(component);\n\t\t\t\t\t\tthis.pushToHistory();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\tif (!Object.keys(nextProps.selectedValues).length) {\n\t\t\t\tArray.from(this.props.params.keys()).forEach((item) => {\n\t\t\t\t\tthis.props.params.delete(item);\n\t\t\t\t});\n\t\t\t\tthis.pushToHistory();\n\t\t\t}\n\t\t}\n\n\t\tif (!isEqual(this.props.headers, nextProps.headers)) {\n\t\t\tnextProps.setHeaders(nextProps.headers);\n\t\t}\n\t}\n\n\tgetValue(value) {\n\t\tif (Array.isArray(value) && value.length) {\n\t\t\treturn value.map(item => this.getValue(item));\n\t\t} else if (value && typeof value === 'object') {\n\t\t\t// TODO: support for NestedList\n\t\t\tif (value.location) return value;\n\t\t\treturn value.label || value.key || null;\n\t\t}\n\t\treturn value;\n\t}\n\n\tsetURL(component, value) {\n\t\tif (!value || (typeof value === 'string' && value.trim() === '')\n\t\t\t|| (Array.isArray(value) && value.length === 0)) {\n\t\t\tthis.props.params.delete(component);\n\t\t\tthis.pushToHistory();\n\t\t} else {\n\t\t\tconst data = JSON.stringify(this.getValue(value));\n\t\t\tif (data !== this.props.params.get(component)) {\n\t\t\t\tthis.props.params.set(component, data);\n\t\t\t\tthis.pushToHistory();\n\t\t\t}\n\t\t}\n\t}\n\n\tpushToHistory() {\n\t\tif (window.history.pushState) {\n\t\t\tconst paramsSting = this.props.params.toString() ? `?${this.props.params.toString()}` : '';\n\t\t\tconst base = window.location.href.split('?')[0];\n\t\t\tconst newurl = `${base}${paramsSting}`;\n\t\t\twindow.history.pushState({ path: newurl }, '', newurl);\n\t\t}\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<Base style={this.props.style} className={this.props.className}>\n\t\t\t\t{this.props.children}\n\t\t\t</Base>\n\t\t);\n\t}\n}\n\nURLParamsProvider.propTypes = {\n\tsetHeaders: types.func,\n\tselectedValues: types.selectedValues,\n\t// component props\n\tchildren: types.children,\n\theaders: types.headers,\n\tparams: types.params,\n\tstyle: types.style,\n\tclassName: types.string,\n};\n\nURLParamsProvider.defaultProps = {\n\tstyle: {},\n\tclassName: null,\n};\n\nconst mapStateToProps = state => ({\n\tselectedValues: state.selectedValues,\n});\n\nconst mapDispatchtoProps = dispatch => ({\n\tsetHeaders: headers => dispatch(setHeaders(headers)),\n});\n\nexport default connect(mapStateToProps, mapDispatchtoProps)(URLParamsProvider);\n"]}